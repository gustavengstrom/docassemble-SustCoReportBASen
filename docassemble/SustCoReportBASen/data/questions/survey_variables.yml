---
#! designed survey scales
mandatory: True
code: |
  from collections import OrderedDict


  orgform_dropdown = OrderedDict([ ('Limited company', 'Limited company'),('Non-profit', 'Non-profit'), ('Economic association', 'Economic association'), ('Individual business activity', 'Individual business activity'), (' Other ',' Other ')])

  industry_dropdown = OrderedDict([('Agriculture, forestry and fishing', 'Agriculture, forestry and fishing'), ('Industry', 'Industry'), ('Construction', 'Construction'), ('Trade', 'Trade'), (' Transport ',' Transport '), (' Visiting industry ',' Visiting industry '), (' Information, including IT ',' Information, including IT '), (' Real estate ',' Real estate '), (' Business services' , 'Business services'), (' School, education ',' School, education '), (' Care and nursing ',' Care and nursing '), (' Personal services', 'Personal services'), (' Other ',' Other ')])

  country_dropdown = OrderedDict([
    ("Afghanistan","Afghanistan"),
    ("Albania","Albania"),
    ("Algeria","Algeria"),
    ("Andorra","Andorra"),
    ("Angola","Angola"),
    ("Antigua and Barbuda","Antigua and Barbuda"),
    ("Argentina","Argentina"),
    ("Armenia","Armenia"),
    ("Australia","Australia"),
    ("Austria","Austria"),
    ("Azerbaijan","Azerbaijan"),
    ("Bahamas","Bahamas"),
    ("Bahrain","Bahrain"),
    ("Bangladesh","Bangladesh"),
    ("Barbados","Barbados"),
    ("Belarus","Belarus"),
    ("Belgium","Belgium"),
    ("Belize","Belize"),
    ("Benin","Benin"),
    ("Bhutan","Bhutan"),
    ("Bolivia","Bolivia"),
    ("Bosnia and Herzegovina","Bosnia and Herzegovina"),
    ("Botswana","Botswana"),
    ("Brazil","Brazil"),
    ("Brunei","Brunei"),
    ("Bulgaria","Bulgaria"),
    ("Burkina Faso","Burkina Faso"),
    ("Burundi","Burundi"),
    ("Côte d'Ivoire","Côte d'Ivoire"),
    ("Cabo Verde","Cabo Verde"),
    ("Cambodia","Cambodia"),
    ("Cameroon","Cameroon"),
    ("Canada","Canada"),
    ("Central African Republic","Central African Republic"),
    ("Chad","Chad"),
    ("Chile","Chile"),
    ("China","China"),
    ("Colombia","Colombia"),
    ("Comoros","Comoros"),
    ("Congo (Congo-Brazzaville)","Congo (Congo-Brazzaville)"),
    ("Costa Rica","Costa Rica"),
    ("Croatia","Croatia"),
    ("Cuba","Cuba"),
    ("Cyprus","Cyprus"),
    ("Czechia (Czech Republic)","Czechia (Czech Republic)"),
    ("Democratic Republic of the Congo","Democratic Republic of the Congo"),
    ("Denmark","Denmark"),
    ("Djibouti","Djibouti"),
    ("Dominica","Dominica"),
    ("Dominican Republic","Dominican Republic"),
    ("Ecuador","Ecuador"),
    ("Egypt","Egypt"),
    ("El Salvador","El Salvador"),
    ("Equatorial Guinea","Equatorial Guinea"),
    ("Eritrea","Eritrea"),
    ("Estonia","Estonia"),
    ("Ethiopia","Ethiopia"),
    ("Fiji","Fiji"),
    ("Finland","Finland"),
    ("France","France"),
    ("Gabon","Gabon"),
    ("Gambia","Gambia"),
    ("Georgia","Georgia"),
    ("Germany","Germany"),
    ("Ghana","Ghana"),
    ("Greece","Greece"),
    ("Grenada","Grenada"),
    ("Guatemala","Guatemala"),
    ("Guinea","Guinea"),
    ("Guinea-Bissau","Guinea-Bissau"),
    ("Guyana","Guyana"),
    ("Haiti","Haiti"),
    ("Holy See","Holy See"),
    ("Honduras","Honduras"),
    ("Hungary","Hungary"),
    ("Iceland","Iceland"),
    ("India","India"),
    ("Indonesia","Indonesia"),
    ("Iran","Iran"),
    ("Iraq","Iraq"),
    ("Ireland","Ireland"),
    ("Israel","Israel"),
    ("Italy","Italy"),
    ("Jamaica","Jamaica"),
    ("Japan","Japan"),
    ("Jordan","Jordan"),
    ("Kazakhstan","Kazakhstan"),
    ("Kenya","Kenya"),
    ("Kiribati","Kiribati"),
    ("Kuwait","Kuwait"),
    ("Kyrgyzstan","Kyrgyzstan"),
    ("Laos","Laos"),
    ("Latvia","Latvia"),
    ("Lebanon","Lebanon"),
    ("Lesotho","Lesotho"),
    ("Liberia","Liberia"),
    ("Libya","Libya"),
    ("Liechtenstein","Liechtenstein"),
    ("Lithuania","Lithuania"),
    ("Luxembourg","Luxembourg"),
    ("Madagascar","Madagascar"),
    ("Malawi","Malawi"),
    ("Malaysia","Malaysia"),
    ("Maldives","Maldives"),
    ("Mali","Mali"),
    ("Malta","Malta"),
    ("Marshall Islands","Marshall Islands"),
    ("Mauritania","Mauritania"),
    ("Mauritius","Mauritius"),
    ("Mexico","Mexico"),
    ("Micronesia","Micronesia"),
    ("Moldova","Moldova"),
    ("Monaco","Monaco"),
    ("Mongolia","Mongolia"),
    ("Montenegro","Montenegro"),
    ("Morocco","Morocco"),
    ("Mozambique","Mozambique"),
    ("Myanmar (formerly Burma)","Myanmar (formerly Burma)"),
    ("Namibia","Namibia"),
    ("Nauru","Nauru"),
    ("Nepal","Nepal"),
    ("Netherlands","Netherlands"),
    ("New Zealand","New Zealand"),
    ("Nicaragua","Nicaragua"),
    ("Niger","Niger"),
    ("Nigeria","Nigeria"),
    ("North Korea","North Korea"),
    ("North Macedonia","North Macedonia"),
    ("Norway","Norway"),
    ("Oman","Oman"),
    ("Pakistan","Pakistan"),
    ("Palau","Palau"),
    ("Palestine State","Palestine State"),
    ("Panama","Panama"),
    ("Papua New Guinea","Papua New Guinea"),
    ("Paraguay","Paraguay"),
    ("Peru","Peru"),
    ("Philippines","Philippines"),
    ("Poland","Poland"),
    ("Portugal","Portugal"),
    ("Qatar","Qatar"),
    ("Romania","Romania"),
    ("Russia","Russia"),
    ("Rwanda","Rwanda"),
    ("Saint Kitts and Nevis","Saint Kitts and Nevis"),
    ("Saint Lucia","Saint Lucia"),
    ("Saint Vincent and the Grenadines","Saint Vincent and the Grenadines"),
    ("Samoa","Samoa"),
    ("San Marino","San Marino"),
    ("Sao Tome and Principe","Sao Tome and Principe"),
    ("Saudi Arabia","Saudi Arabia"),
    ("Senegal","Senegal"),
    ("Serbia","Serbia"),
    ("Seychelles","Seychelles"),
    ("Sierra Leone","Sierra Leone"),
    ("Singapore","Singapore"),
    ("Slovakia","Slovakia"),
    ("Slovenia","Slovenia"),
    ("Solomon Islands","Solomon Islands"),
    ("Somalia","Somalia"),
    ("South Africa","South Africa"),
    ("South Korea","South Korea"),
    ("South Sudan","South Sudan"),
    ("Spain","Spain"),
    ("Sri Lanka","Sri Lanka"),
    ("Sudan","Sudan"),
    ("Suriname","Suriname"),
    ("Sweden","Sweden"),
    ("Switzerland","Switzerland"),
    ("Syria","Syria"),
    ("Tajikistan","Tajikistan"),
    ("Tanzania","Tanzania"),
    ("Thailand","Thailand"),
    ("Timor-Leste","Timor-Leste"),
    ("Togo","Togo"),
    ("Tonga","Tonga"),
    ("Trinidad and Tobago","Trinidad and Tobago"),
    ("Tunisia","Tunisia"),
    ("Turkey","Turkey"),
    ("Turkmenistan","Turkmenistan"),
    ("Tuvalu","Tuvalu"),
    ("Uganda","Uganda"),
    ("Ukraine","Ukraine"),
    ("United Arab Emirates","United Arab Emirates"),
    ("United Kingdom","United Kingdom"),
    ("United States of America","United States of America"),
    ("Uruguay","Uruguay"),
    ("Uzbekistan","Uzbekistan"),
    ("Vanuatu","Vanuatu"),
    ("Venezuela","Venezuela"),
    ("Vietnam","Vietnam"),
    ("Yemen","Yemen"),
    ("Zambia","Zambia"),
    ("Zimbabwe","Zimbabwe"),])
    
    
  employee_dropdown = OrderedDict([('No employees', 'No employees'), ('1-5 employees', '1-5 employees'), ('6-25 employees', '6-25 employees'), ('26-50 employees', '26-50 employees'), ('51-100 employees', '51-100 employees'), ('101-250 employees','101-250 employees'), ('More than 250 employees','More than 250 employees')])

  turnaround_dropdown = OrderedDict([ ('Less than USD 100 000', 'Less than USD 100 000'), ('USD 100-300 000', 'USD 100-300 000'), ('USD 300-500 000', 'USD 300-500 000'), ('USD 500 000-1 000 000','USD 500 000-1 000 000'), ('USD 1 000 000-5 000 000', 'USD 1 000 000-5 000 000'), ('USD 5 000 000-10 000 000', 'USD 5 000 000-10 000 000'), ('More than USD 10 000 000','More than USD 10 000 000') ])

  region_dropdown = OrderedDict([ ('Blekinge','Blekinge'), ('Dalarna','Dalarna'), ('Gotland','Gotland'), ('Gävleborg','Gävleborg'), ('Halland','Halland'), ('Jämtland Härjedalen','Jämtland Härjedalen'), ('Jönköpings län','Jönköpings län'), ('Kalmar län','Kalmar län'), ('Kronoberg','Kronoberg'), ('Norrbotten','Norrbotten'), ('Skåne','Skåne'), ('Stockholm','Stockholm'), ('Sörmland','Sörmland'), ('Uppsala','Uppsala'), ('Värmland','Värmland'), ('Västerbotten','Västerbotten'), ('Västernorrland','Västernorrland'), ('Västmanland','Västmanland'), ('Örebro län','Örebro län'), ('Östergötland','Östergötland'), ('Västra Götaland','Västra Götaland')])


  scr_importance_likert = OrderedDict([ (1.0, '5 - Very important'), (0.75, '4 - Rather important'), (0.5, '3 - Neither'), (0.25, '2 - Rather unimportant'), (0.1, '1 - Very unimportant '), ])

  scr_significance_likert = OrderedDict([ (1.0, '5 - Significant positive impact'), (0.75, '4 - Some positive impact'), (0.5, '3 - No direct impact'), (0.25, '2 - Some negative impact'), (0.1 , '1 - Significant negative impact'),])

  scr_application_likert = OrderedDict([ (1.0, '5 - Very large extent'), (0.75, '4 - Large extent'), (0.5, '3 - Some extent'), (0.25, '2 - Small extent'), (0.1, '1 - Not applicable'),])

  scr_effect_likert = OrderedDict( [(1.0, 'Large positive effect'), (0.75, 'Some positive effect'), (0.5, 'No effect'), (0.25, 'Some negative effect'), (0.1, 'Large negative effect'),] )

  scr_effect_stakeholders = OrderedDict([(1.0, 'Very large extent'), (0.75, 'Large extent'), (0.5, 'Some extent'), (0.25, 'Small extent'), (0.1, 'Not applicable') ])

---

table: results_table
rows: results
show: True
require gathered: True
columns:
# backgrounds varible
  - Namn: row_item.person_name
  - Organisation: row_item.name
  - Organisationsform: row_item.org_form
  - Datum: row_item.date
  - Bransch: row_item.industry
  - Land: row_item.country
  - Region: row_item.region
  - Anställda: row_item.employee
  - Omsättning: row_item.turnaround
  - Verksamhetsinriktning: str(row_item.op_focus.true_values())#.replace(" and ", " och ")
  - Verksamhetsinriktning_list: json.dumps([k for k,v in row_item.op_focus.items() if v == True])
# Q5 - sustainability principles
  - Q5_ansvarighet: row_item.q5_respb_imp_est
  - Q5_ansvarighet_tillämp: row_item.q5_respb_imp_app
  - Q5_ansvarighet_10: row_item.q5_respb_imp_10
  - Q5_ansvarighet_intressent: row_item.q5_respb_imp_stakeh
  - Q5_transparens: row_item.q5_trans_imp_est
  - Q5_transparens_tillämp: row_item.q5_trans_imp_app
  - Q5_transparens_10: row_item.q5_trans_imp_10
  - Q5_transparens_intressent: row_item.q5_trans_imp_stakeh
  - Q5_etiskt_uppförande: row_item.q5_ethic_imp_est
  - Q5_etiskt_uppförande_tillämp: row_item.q5_ethic_imp_app
  - Q5_etiskt_uppförande_10 : row_item.q5_ethic_imp_10
  - Q5_etiskt_uppförande_intressent : row_item.q5_ethic_imp_stakeh
  - Q5_intressenternas_intressen: row_item.q5_resp_stake_imp_est
  - Q5_intressenternas_intressen_tillämp: row_item.q5_resp_stake_imp_app
  - Q5_intressenternas_intressen_10: row_item.q5_resp_stake_imp_10
  - Q5_intressenternas_intressen_intressent: row_item.q5_resp_stake_imp_stakeh
  - Q5_rättsstatens_principer: row_item.q5_resp_state_imp_est
  - Q5_rättsstatens_principer_tillämp: row_item.q5_resp_state_imp_app
  - Q5_rättsstatens_principer_10: row_item.q5_resp_state_imp_10
  - Q5_rättsstatens_principer_intressent: row_item.q5_resp_state_imp_stakeh
  - Q5_internationella_uppförandenormer: row_item.q5_resp_int_imp_est
  - Q5_internationella_uppförandenormer_tillämp: row_item.q5_resp_int_imp_app
  - Q5_internationella_uppförandenormer_10: row_item.q5_resp_int_imp_10
  - Q5_internationella_uppförandenormer_intressent: row_item.q5_resp_int_imp_stakeh
  - Q5_mänskliga_rättigheter: row_item.q5_resp_hr_imp_est
  - Q5_mänskliga_rättigheter_tillämp: row_item.q5_resp_hr_imp_app
  - Q5_mänskliga_rättigheter_10: row_item.q5_resp_hr_imp_10
  - Q5_mänskliga_rättigheter_intressent: row_item.q5_resp_hr_imp_stakeh
# Q11 - responsebility areas of operations  
  - Q11_verk_organisation: row_item.q11_operation_est
  - Q11_verk_bransch: row_item.q11_operation_est_industry
  - Q11_verk_intressent: row_item.q11_operation_est_stakeh
  - Q11_verk_10: row_item.q11_operation_est_industry_10
  - Q11_mr_organisation: row_item.q11_mr_est
  - Q11_mr_bransch: row_item.q11_mr_est_industry
  - Q11_mr_intressent: row_item.q11_mr_est_stakeh
  - Q11_mr_10: row_item.q11_mr_est_industry_10
  - Q11_arb_organisation: row_item.q11_arb_est
  - Q11_arb_bransch: row_item.q11_arb_est_industry
  - Q11_arb_intressent: row_item.q11_arb_est_stakeh
  - Q11_arb_10: row_item.q11_arb_est_industry_10
  - Q11_milj_organisation: row_item.q11_milj_est
  - Q11_milj_bransch: row_item.q11_milj_est_industry
  - Q11_milj_intressent: row_item.q11_milj_est_stakeh
  - Q11_milj_10: row_item.q11_milj_est_industry_10
  - Q11_gverk_organisation: row_item.q11_gverk_est
  - Q11_gverk_bransch: row_item.q11_gverk_est_industry
  - Q11_gverk_intressent: row_item.q11_gverk_est_stakeh
  - Q11_gverk_10: row_item.q11_gverk_est_industry_10
  - Q11_konsum_organisation: row_item.q11_konsum_est
  - Q11_konsum_bransch: row_item.q11_konsum_est_industry
  - Q11_konsum_intressent: row_item.q11_konsum_est_stakeh
  - Q11_konsum_10: row_item.q11_konsum_est_industry_10
  - Q11_samutv_organisation: row_item.q11_samutv_est
  - Q11_samutv_bransch: row_item.q11_samutv_est_industry
  - Q11_samutv_intressent: row_item.q11_samutv_est_stakeh
  - Q11_samutv_10: row_item.q11_samutv_est_industry_10
# Q7/8 - stakeholder assessment
  - Q8_intressent_vikt: str(row_item.import_stakeholders.true_values())#.replace(" and ", " och ")
  - Q8_intressent_vikt_list: json.dumps([k for k,v in row_item.import_stakeholders.items() if v == True])
  - Q8_intressent_vikt_princip: str(row_item.import_stakeholders_ind.true_values())#.replace(" and ", " och ")
  - Q8_intressent_vikt_princip_list: json.dumps([k for k,v in row_item.import_stakeholders_ind.items() if v == True])
  - Q8_intressent_vikt_ansvarsområde: str(row_item.import_stakeholders_ind_10.true_values())#.replace(", and ", ", och ")
  - Q8_intressent_vikt_ansvarsområde_list: json.dumps([k for k,v in row_item.import_stakeholders_ind_10.items() if v == True])

# Q11/38 & Q13/22 - prio & sustainability areas of operations 
  - Q22_org_prio_verksamhet: row_item.q0_prio_oper_est
  - Q22_org_prio_mr: row_item.q0_prio_mr_est
  - Q22_org_prio_arbförhåll: row_item.q0_prio_work_est
  - Q22_org_prio_miljö: row_item.q0_prio_env_est
  - Q22_org_prio_verkmetod: row_item.q0_prio_good_work_est
  - Q22_org_prio_konsumentfråg: row_item.q0_prio_consum_est
  - Q22_org_prio_samhällutv: row_item.q0_prio_soc_dev_est
  - Q22_sdg_organisation: str(row_item.q22_sdg_org.true_values())#.replace(" and ", " och ")
  - Q22_sdg_organisation_list: json.dumps([k for k,v in row_item.q22_sdg_org.items() if v == True])
  - Q22_sdg_världen: str(row_item.q22_sdg_world.true_values())#.replace(" and ", " och ")
  - Q22_sdg_världen_list: json.dumps([k for k,v in row_item.q22_sdg_world.items() if v == True])

---

